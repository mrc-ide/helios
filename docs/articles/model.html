<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Technical model description • helios</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Technical model description">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">helios</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/helios.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/model.html">Technical model description</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-working-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Working reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-working-reports">
<li><a class="dropdown-item" href="../articles/blueprint.html">Assessing far UVC interventions with an individual based infectious disease model</a></li>
    <li><a class="dropdown-item" href="../articles/blueprint-july.html">Update to "Assessing far UVC interventions with an individual based infectious disease model"</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/helios/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Technical model description</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/helios/blob/HEAD/vignettes/model.Rmd" class="external-link"><code>vignettes/model.Rmd</code></a></small>
      <div class="d-none name"><code>model.Rmd</code></div>
    </div>

    
    
<div class="alert alert-warning">
<p>This vignette is not up to date with latest changes to the model!</p>
</div>
<p>This vignette describes the modelling approach used in <a href="https://mrc-ide.github.io/helios/"><code>helios</code></a>. For an
introduction to practical use of the package, see the <a href="https://mrc-ide.github.io/helios/articles/helios.html">Get
started</a> vignette.</p>
<div class="section level2">
<h2 id="population">Population<a class="anchor" aria-label="anchor" href="#population"></a>
</h2>
<p>The population consists of a fixed number of individuals <span class="math inline">\(i = 1, \ldots, N\)</span>. Each individual has
properties. Some properties remain constant during the simulation, and
others change.</p>
</div>
<div class="section level2">
<h2 id="age">Age structure<a class="anchor" aria-label="anchor" href="#age"></a>
</h2>
<p>The age categories included in the model are children, adults, and
the elderly. Each individual has a fixed age category, assumed not to
change during the simulation. The age category is sampled from a
categorical distribution at initialisation such that <span class="math display">\[
\mathbb{P}(\text{age}_i = k) = p_k, \\
k \in \{\text{child}, \text{adult}, \text{elderly}\}.
\]</span></p>
</div>
<div class="section level2">
<h2 id="households">Households<a class="anchor" aria-label="anchor" href="#households"></a>
</h2>
<p>Households are comprised of collections of one or more individuals.
We consider two approaches.</p>
<div class="section level3">
<h3 id="parametric">Parametric<a class="anchor" aria-label="anchor" href="#parametric"></a>
</h3>
<p>In the parameteric approach, household sizes <span class="math inline">\(N_j^\text{household}\)</span> are drawn from a
Poisson distribution with rate parameter <span class="math inline">\(\lambda^\text{household}\)</span> <span class="math display">\[
N_j^\text{household} \sim \text{Poisson}(\lambda^\text{household}).
\]</span> Individuals are then assigned to households. To ensure that no
household contains only children, one adult is paired to each child
assigned to a household without any existing adults.</p>
</div>
<div class="section level3">
<h3 id="bootstrap">Bootstrap<a class="anchor" aria-label="anchor" href="#bootstrap"></a>
</h3>
<p>In the bootstrap approach, households and age distributions are
sampled with replacement from a reference data set. The reference data
<code>baseline_household_demographics</code> are derived from the Office
for National Statistics 2011 survey as used by <span class="citation">Hinch et al. (2021)</span>. If the bootstrap approach
is used, then its age structure will overwrite the categorical age
structure above.</p>
</div>
</div>
<div class="section level2">
<h2 id="schools">Schools<a class="anchor" aria-label="anchor" href="#schools"></a>
</h2>
<p>All children attend schools. Two approaches to the number of children
attending each school are considered.</p>
<div class="section level3">
<h3 id="parametric-1">Parametric<a class="anchor" aria-label="anchor" href="#parametric-1"></a>
</h3>
<p>In the parametric approach, the sizes of schools are drawn from a
log-normal distribution with mean <span class="math inline">\(\mu^\text{school}\)</span> and variance <span class="math inline">\({\sigma^\text{school}}^2\)</span> <span class="math display">\[
N^\text{school}_j \sim \text{Lognormal}(\mu^\text{school},
{\sigma^\text{school}}^2).
\]</span> Schools <span class="math inline">\(j\)</span> are drawn until
<span class="math inline">\(\sum_j N^\text{school}_j \geq
N^\text{child}\)</span>. Any samples <span class="math inline">\(N^\text{school}_j &gt;
N^\text{school}_\text{max}  \in \mathbb{N}\)</span> are discarded. The
final school size is adjusted such that the sum of school sizes
corresponds to the number of children. Assignment of children to
particular schools is made using random sampling without
replacement.</p>
</div>
<div class="section level3">
<h3 id="bootstrap-1">Bootstrap<a class="anchor" aria-label="anchor" href="#bootstrap-1"></a>
</h3>
<p>In the bootstrap approach, school sizes are sampled with replacement
from a reference data set. The reference data
<code>schools_england</code> are obtained from the 2022/23 census of
schools in England.</p>
</div>
<div class="section level3">
<h3 id="school-staff">School staff<a class="anchor" aria-label="anchor" href="#school-staff"></a>
</h3>
<p>A small number of adults attend schools as staff. Each school has a
fixed staff to student ratio, with the number of staff rounded up to the
nearest integer.</p>
</div>
</div>
<div class="section level2">
<h2 id="workplaces">Workplaces<a class="anchor" aria-label="anchor" href="#workplaces"></a>
</h2>
<p>Workplaces are attended by adults who are not school staff. Following
<span class="citation">Ferguson et al. (2005)</span>, the sizes of
workplaces <span class="math inline">\(N^\text{workplace}_j\)</span> are
drawn from an offset truncated power distribution. The cumulative
distribution function is <span class="math display">\[
\mathbb{P}(N^\text{workplace}_j &gt; N) = \frac{\left( \frac{1 +
N^\text{workplace}_\text{max} / a}{1 + m / a} \right) ^ c - 1}{(1 +
N^\text{workplace}_\text{max} / a)^c - 1}, \quad \text{for } N \leq
N^\text{workplace}_\text{max},
\]</span> where <span class="math inline">\(a &gt; 0, c &gt; 0\)</span>
and <span class="math inline">\(N^\text{workplace}_\text{max} \in
\mathbb{N}\)</span>. As with the school sizes, workplace sizes are drawn
until their sum exceeds the number of adults who are not school staff.
The final workplace is then adjusted downward. Assignment of adults to
particular workplaces is done using random sampling without
replacement.</p>
</div>
<div class="section level2">
<h2 id="leisure">Leisure<a class="anchor" aria-label="anchor" href="#leisure"></a>
</h2>
<p>Leisure venues are attended by all individuals. Leisure venue sizes
are drawn from a negative binomial distribution <span class="math display">\[
N^\text{leisure}_j \sim \text{NB}(\mu^\text{leisure},
\kappa^\text{leisure}),
\]</span> with mean <span class="math inline">\(\mu^\text{leisure}\)</span> and overdispersion
parameter <span class="math inline">\(\kappa^\text{leisure}\)</span>. As
above, any samples <span class="math inline">\(N^\text{leisure}_j &gt;
N^\text{leisure}_\text{max} \in \mathbb{N}\)</span> are discarded and
the final sample is adjusted such that <span class="math inline">\(\sum_j N^\text{leisure}_j = N\)</span>. The number
of leisure visits per person per week is drawn from a Poisson
distribution, truncated at 7 corresponding to one leisure visit every
day. The locations for each individual’s leisure visits are sampled
without replacement with probability proportional to leisure venue size.
The day of the week that each individual visits each sampled leisure
location are also sampled without replacement.</p>
</div>
<div class="section level2">
<h2 id="interventions">Interventions<a class="anchor" aria-label="anchor" href="#interventions"></a>
</h2>
<p>To be described once implemented!</p>
</div>
<div class="section level2">
<h2 id="disease-states">Disease states<a class="anchor" aria-label="anchor" href="#disease-states"></a>
</h2>
<p>We consider a SEIR compartmental model with susceptible, exposed,
infectious, and recovered disease states. At a given time, each
individual is in exactly one of the states <span class="math inline">\(\{S, E, I, R\}\)</span>. Transitions between
states are simulated as follows.</p>
<div class="section level3">
<h3 id="transition-from-state-s-to-e">Transition from state <span class="math inline">\(S \to
E\)</span><a class="anchor" aria-label="anchor" href="#transition-from-state-s-to-e"></a>
</h3>
<p>The total force of infection <span class="math inline">\(\lambda\)</span> for each individual is a sum of
household, workplace, school, leisure, and community specific force of
infections <span class="math display">\[
\lambda = \lambda_h + \lambda_w + \lambda_s + \lambda_l.
\]</span> The location specific force of infection terms are given
as:</p>
<ul>
<li>Household <span class="math inline">\(\lambda_h\)</span>:
proportional to the number of infectious individuals in the household
multiplied by <span class="math inline">\(\beta_h\)</span>.</li>
<li>Workplace <span class="math inline">\(\lambda_w\)</span>:
proportional to the number of infectious individuals in the workplace
multiplied by <span class="math inline">\(\beta_w\)</span>.</li>
<li>School <span class="math inline">\(\lambda_s\)</span>: proportional
to the number of infectious individuals in the school multiplied by
<span class="math inline">\(\beta_s\)</span>.</li>
<li>Leisure <span class="math inline">\(\lambda_l\)</span>: proportional
to the number of infectious individuals in the leisure setting
multiplied by <span class="math inline">\(\beta_l\)</span>.</li>
<li>Community <span class="math inline">\(\lambda_c\)</span>:
proportional to the total number of infectious individuals multiplied by
<span class="math inline">\(\beta_c\)</span>.</li>
</ul>
<p>The probability of infection in a given time step <span class="math inline">\(\delta &gt; 0\)</span> is <span class="math display">\[
\mathbb{P}(S \to E) = 1 - \exp(- \lambda \delta)
\]</span></p>
</div>
<div class="section level3">
<h3 id="transition-from-state-e-to-i">Transition from state <span class="math inline">\(E \to
I\)</span><a class="anchor" aria-label="anchor" href="#transition-from-state-e-to-i"></a>
</h3>
<p>Individuals progress from exposed to infectious with a random delay
<span class="math inline">\(d \geq 1\)</span> such that <span class="math display">\[
c \sim \text{Gamma}(2\gamma, 2), \\
d = \text{round}(c + 1).
\]</span> where <span class="math inline">\(\gamma &gt; 0\)</span> is
the duration exposed which we set to 2. The delay <span class="math inline">\(d\)</span> is a number of time steps <span class="math inline">\(\delta\)</span>.</p>
</div>
<div class="section level3">
<h3 id="transition-from-state-i-to-r">Transition from state <span class="math inline">\(I \to
R\)</span><a class="anchor" aria-label="anchor" href="#transition-from-state-i-to-r"></a>
</h3>
<p>Individuals progress from infectious to recovered after a random
disease duration <span class="math inline">\(f \geq 1\)</span> such that
<span class="math display">\[
e \sim \text{Gamma}(2\upsilon, 2), \\
f = \text{round}(e + 1).
\]</span> where <span class="math inline">\(\upsilon\)</span> is the
duration of infectiousness which we set to 4. The disease duration <span class="math inline">\(f\)</span> is a number of time steps <span class="math inline">\(\delta\)</span>.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ferguson2005strategies" class="csl-entry">
Ferguson, Neil M, Derek AT Cummings, Simon Cauchemez, Christophe Fraser,
Steven Riley, Aronrag Meeyai, Sopon Iamsirithaworn, and Donald S Burke.
2005. <span>“Strategies for Containing an Emerging Influenza Pandemic in
Southeast Asia.”</span> <em>Nature</em> 437 (7056): 209–14.
</div>
<div id="ref-hinch2021openabm" class="csl-entry">
Hinch, Robert, William JM Probert, Anel Nurtay, Michelle Kendall, Chris
Wymant, Matthew Hall, Katrina Lythgoe, et al. 2021.
<span>“OpenABM-Covid19—an Agent-Based Model for Non-Pharmaceutical
Interventions Against COVID-19 Including Contact Tracing.”</span>
<em>PLoS Computational Biology</em> 17 (7): e1009146.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Charlie Whittaker, Tom Brewer, Adam Howes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
