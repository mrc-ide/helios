#' Generate a list of the model events and add listeners. Listeners are arbitrary functions called
#' when the event is fired with the current time step, t, as their only arguments.
#'
#' @param parameters_list A list of model parameters as generated by `get_parameters`
#' @param variables_list A list of the model variables as generated by `create_variables`
#'
#' @export
create_events <- function(variables_list, parameters_list) {

  # Open a list to store the model events and populate using the event generator functions:
  events_list <- list(

    # Event moving exposed individuals to the infectious state
    EI_event = TargetedEvent$new(population_size = parameters_list$human_population),

    # Event moving exposed individuals to the infectious state
    IR_event = TargetedEvent$new(population_size = parameters_list$human_population)

  )

  ## Add RS_event if endemic pathogen is required
  if (parameters_list$endemic_or_epidemic == "endemic") {
    RS_event <- TargetedEvent$new(population_size = parameters_list$human_population)
    events_list <- c(events_list, list(RS_event = RS_event))
  }

  # Add listener to the EI event:
  events_list$EI_event$add_listener(
    function(t, target) {
      variables_list$disease_state$queue_update("I", target)
    }
  )

  # Add listener to the IR event:
  events_list$IR_event$add_listener(
    function(t, target) {
      variables_list$disease_state$queue_update("R", target)
    }
  )

  ## Add listener to the RS event if endemic pathogen is required
  if (parameters_list$endemic_or_epidemic == "endemic") {
    events_list$RS_event$add_listener(
      function(t, target) {
        variables_list$disease_state$queue_update("S", target)
      }
    )
  }

  # Return the list of model events:
  events_list
}
